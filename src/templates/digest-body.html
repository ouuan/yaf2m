<div class="digest-wrapper" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; max-width: 60rem; margin: 0 auto; padding: 1.25rem 1.25rem 0.625rem 1.25rem;">
  <div class="digest-header" style="background: #f8f9fa; padding: 1.25rem; border-radius: 0.375rem; border: 1px solid #ececec;">
    <h1 style="margin: 0 0 0.625rem 0; font-size: 1.25em;">ðŸ“¬ {% include "digest-subject" %}</h1>
    <div class="feed-list" style="color: #666; font-size: 0.9em;">
      From:
      {% for feed in feeds %}
        {% if feed.links %}
          <a href="{{ feed.links[0].href }}" style="color: #1a73e8; text-decoration: none;">{{ feed.title.content if feed.title else "Untitled Feed" }}</a>{% if not loop.last %}, {% endif %}
        {% else %}
          {{ feed.title.content if feed.title else "Untitled Feed" }}{% if not loop.last %}, {% endif %}
        {% endif %}
      {% endfor %}
    </div>
  </div>

  {% if items | length >= 2 %}
  <div class="toc" style="background: #fff; padding: 1.25rem; border-radius: 0.375rem; border: 1px solid #e5e5e5; margin-top: 1rem;">
    <h2 style="margin: 0 0 0.75rem 0; font-size: 1.1em; color: #333;">ðŸ“‹ Contents</h2>
    {% for ctx in items %}
      {% set item = ctx.item %}
      {% set feed = ctx.feed %}
      <div style="font-size: 0.9em; margin-bottom: 0.5rem; line-height: 1.4;">
        {% if item.links %}
          <a href="{{ item.links[0].href }}" style="color: #1a0dab; text-decoration: none; font-weight: 500;">{{ item.title.content if item.title else "Untitled" }}</a>
        {% else %}
          <span style="font-weight: 500;">{{ item.title.content if item.title else "Untitled" }}</span>
        {% endif %}
        <span style="color: #666;">
          {% set ts = item.published or item.updated %}
          {% if ts %} Â· {{ ts | datetimeformat(format="short", tz=template_args.tz or "UTC") }}{% endif %}
          {% if item.authors %} Â· {% for author in item.authors %}
            {% if author.name == "author" and author.email %}
              {% set display = author.email %}
            {% else %}
              {% set display = author.name %}
            {% endif %}
            {% if author.url %}<a href="{{ author.url }}" style="color: #666;">{{ display }}</a>{% else %}{{ display }}{% endif %}
            {% if not loop.last %}, {% endif %}
          {% endfor %}{% endif %}
          {% if feed.title and feeds | length > 1 %} Â· {% if feed.links %}<a href="{{ feed.links[0].href }}" style="color: #666; text-decoration: none;">{{ feed.title.content }}</a>{% else %}{{ feed.title.content }}{% endif %}{% endif %}
        </span>
      </div>
    {% endfor %}
  </div>
  {% endif %}

  {% for ctx in items %}
    {% set feed = ctx.feed %}
    {% set item = ctx.item %}
    {% include "item-body" %}
  {% endfor %}
</div>
